{"version":3,"file":"bundle.js","sources":["../src/utils.js","../src/create_element.js","../src/create_vdom.js","../src/render.js","../src/constants.js","../src/diff.js","../src/index.js"],"sourcesContent":["let utils = {};\n\nutils.isType = (type, target) => {\n  return Object.prototype.toString.call(target) === `[object ${type}]`;\n};\n\n['String', 'Boolean', 'Number', 'Array', 'Function', 'Object', 'Date', 'RegExp', 'Error'].forEach(type => {\n  utils[`is${type}`] = (target) => utils.isType(type, target);\n});\n\n\n// props 中关于 html 属性的处理\n// 暂时只处理一部分，仅供演示\n// 注意 className、内联样式 style\nutils.setAttrs = (el, props) => {\n  for (let key in props) {\n    if (['id', 'href', 'value'].indexOf(key) !== -1) {\n      el.setAttribute(key, props[key])\n    }\n    if (key === 'className') {\n      el.setAttribute('class', props['className']);\n    }\n    if (key === 'style') {\n      for (let p in props.style) {\n        el.style[p] = props.style[p];\n      }\n    }\n  }\n};\n\nexport default utils;\n","// 参考 React 实现一个精简版的 createElement 方法\n\nfunction createElement(type, props, children) {\n  let element = {\n    key: (props && props.key) | null,\n    type: type,\n    props: props ? props : {}\n  };\n\n  if (children && children.length >= 1) {\n    element.children = children;\n  }\n\n  return element;\n}\n\nexport default createElement;\n","import utils from './utils';\n\n\nfunction createVdom(element) {\n  let { type, props, children } = element;\n\n  // type 类型判断，按照 React 的套路，可能是html标签、文本、函数、React组件，\n  // 这里暂时只处理html标签及文本的情况\n  // jsx 解析后文本为字符串，html标签会解析为对象\n\n  let el = document.createElement(type);\n  utils.setAttrs(el, props);\n\n  if (!children) {\n    return el;\n  }\n\n  children.forEach(child => {\n    let elChild;\n    if (utils.isString(child)) {\n      elChild = document.createTextNode(child);\n    }\n    if (utils.isObject(child)) {\n      elChild = createVdom(child);\n    }\n    el.appendChild(elChild);\n  });\n\n  return el;\n}\n\nexport default createVdom;\n","function render(vdom, el) {\n  el.appendChild(vdom)\n}\n\nexport default render;\n","// patchType 替换节点\nexport const REPLACE = 'REPLACE';\n\n// patchType 重新排列节点\nexport const REORDER = 'REORDER';\n\n// patchType 属性修改\nexport const PROPS = 'PROPS';\n\n// patchType 文本修改\nexport const TEXT = 'TEXT';\n","import utils from './utils';\nimport { REPLACE, REORDER, PROPS, TEXT } from './constants';\n\nfunction diff(node, newNode) {\n  console.log('diff');\n  let index = 0;\n  let patches = {};\n\n  diffByType(node, newNode, index, patches);\n\n  return patches;\n}\n\nfunction diffByType(node, newNode, index, patches) {\n  let currentPatch = [];\n\n  if (utils.isString(node) && utils.isString(newNode)) {\n    // 新旧节点均为文本且不一样\n    if (node !== newNode) {\n      currentPatch.push({\n        type: TEXT,\n        content: newNode\n      });\n    }\n  }\n\n}\n\nexport default diff;\n","import utils from './utils';\n\nimport createElement from './create_element';\nimport createVdom from './create_vdom';\nimport render from './render';\nimport diff from './diff';\nimport patch from './patch'\n\n// jsx 被 babel 编译后会转化为 createElement 的形式，\nlet elements = createElement('div', { className: 'box', id: 'box' }, [\n  createElement('p', { style: { color: '#36f' } }, ['hello walker']),\n  createElement('ul', { className: 'lists' }, [\n    createElement('li', null, [`Item 1`]),\n    createElement('li', null, [`Item 2`]),\n    createElement('li', null, [`Item 3`])\n  ])\n]);\n\nconsole.log('elements: ', elements);\n\nlet vdom = createVdom(elements);\n\nconsole.log('vdom: ', vdom);\n\nrender(vdom, document.getElementById('app'));\n\n\nlet newElements = createElement('div', { className: 'box', id: 'box' }, [\n  createElement('h1', { id: 'title' }, ['This is title']),\n  createElement('p', { style: { color: '#f80' } }, ['hello walker, nice to meet you']),\n  createElement('ul', { className: 'lists new-lists' }, [\n    createElement('li', null, [`Item 1`]),\n    createElement('li', null, [`Item 2`]),\n    createElement('li', null, [`Item 3`]),\n    createElement('li', null, [`Item 4`]),\n  ])\n]);\n\nlet patches = diff(elements, newElements);\n\nconsole.log('patches: ', patches);\n\n"],"names":["utils","isType","type","target","Object","prototype","toString","call","forEach","setAttrs","el","props","key","indexOf","setAttribute","p","style","createElement","children","element","length","createVdom","document","child","elChild","isString","createTextNode","isObject","appendChild","render","vdom","diff","node","newNode","console","log","index","patches","diffByType","elements","className","id","color","getElementById","newElements"],"mappings":"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"}